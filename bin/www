/**
 * Module dependencies.
 */
let fs = require("fs");
let path = require("path");

//Environment variable Setup
if(process.env.NODE_ENV==="development"){
  require('dotenv').config({ path: path.resolve(__dirname+"/../.env.devlopment") });
} else {
  require('dotenv').config();
}

let {logError, logDebug, logInfo} = require("../lib/log");

/**
 * Get port from environment and store in Express.
 */
let port = process.env.PORT;

/**
 * Create HTTP server.
 */
let server = null;
let app = require('../app');
let http = require('http');
server = http.createServer(app);


/**
 * Socket io
 */
let InitSocketIO = require("../lib/sock");

InitSocketIO(server);
/**
 * Listen on provided port, on all network interfaces.
 */
server.listen(port);
server.on('error', logError);
server.on('listening', onListening);
/**
 * Event listener for HTTP server "listening" event.
 */

function onListening() {
  let adder = server.address();
  let bind = typeof adder === 'string'
      ? 'pipe ' + adder
      : 'port ' + adder.port;
  logInfo('Listening on ' + bind);
}

